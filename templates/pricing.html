{% extends "base.html" %}

{% block title %}–ü–ª–∞–Ω—ã –ø–æ–¥–ø–∏—Å–∫–∏ - AI Study{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row justify-content-center">
        <div class="col-12">
            <div class="text-center mb-5">
                <h1 class="display-4 fw-bold text-primary mb-3">–í—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ–π –ø–ª–∞–Ω</h1>
                <p class="lead text-muted">–ü–æ–ª—É—á–∏—Ç–µ –º–∞–∫—Å–∏–º—É–º –æ—Ç AI-–∞–Ω–∞–ª–∏–∑–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</p>
            </div>
            


            <div class="row justify-content-center g-3">
                <!-- FREEMIUM Plan -->
                <div class="col-xl-2-4 col-lg-3 col-md-6">
                    <div class="card h-100 border-0 shadow-sm">
                        <div class="card-body p-3 text-center">
                            <h3 class="card-title h6 mb-2">FREEMIUM</h3>
                            <div class="mb-3">
                                <span class="h4 fw-bold text-secondary">‚ÇΩ0</span>
                                <div class="text-muted small">–Ω–∞–≤—Å–µ–≥–¥–∞</div>
                            </div>
                            
                            <ul class="list-unstyled text-start mb-3 small">
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    3 –∞–Ω–∞–ª–∏–∑–∞ –≤ –º–µ—Å—è—Ü
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    –î–æ 5 —Å—Ç—Ä–∞–Ω–∏—Ü PDF
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    1 –≤–∏–¥–µ–æ –¥–æ 10 –º–∏–Ω—É—Ç
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    10 AI —Å–æ–æ–±—â–µ–Ω–∏–π
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    –ë–∞–∑–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
                                </li>
                            </ul>
                            
                            {% if current_user.is_authenticated and user_subscription.type == 'freemium' %}
                                <button class="btn btn-outline-secondary btn-sm w-100" disabled>
                                    –¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω
                                </button>
                            {% else %}
                                <button class="btn btn-outline-secondary btn-sm w-100" onclick="selectPlan('freemium')">
                                    –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å
                                </button>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- LITE Plan - –ù–û–í–´–ô -->
                <div class="col-xl-2-4 col-lg-3 col-md-6">
                    <div class="card h-100 border-info shadow-sm position-relative">
                        <div class="position-absolute top-0 start-50 translate-middle">
                            <span class="badge bg-info text-white px-2 py-1 rounded-pill small">
                                üöÄ –ù–û–í–´–ô
                            </span>
                        </div>
                        <div class="card-body p-3 text-center">
                            <h3 class="card-title h6 mb-2 text-info">LITE</h3>
                            <div class="mb-3">
                                <span class="h4 fw-bold text-info">‚ÇΩ79</span>
                                <div class="text-muted small">–≤ –Ω–µ–¥–µ–ª—é</div>
                                <div class="text-success" style="font-size: 0.7rem;">‚ÇΩ11/–¥–µ–Ω—å</div>
                            </div>
                            
                            <ul class="list-unstyled text-start mb-3 small">
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    8 –∞–Ω–∞–ª–∏–∑–æ–≤ –≤ –º–µ—Å—è—Ü
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    –î–æ 15 —Å—Ç—Ä–∞–Ω–∏—Ü PDF
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    3 –≤–∏–¥–µ–æ –¥–æ 20 –º–∏–Ω—É—Ç
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    50 AI —Å–æ–æ–±—â–µ–Ω–∏–π
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    –ü–æ–ª–Ω—ã–µ mind maps
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑—É—á–µ–Ω–∏—è
                                </li>
                            </ul>
                            
                            {% if current_user.is_authenticated and user_subscription.type == 'lite' %}
                                <button class="btn btn-info btn-sm w-100" disabled>
                                    –¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω
                                </button>
                            {% else %}
                                <button class="btn btn-info btn-sm w-100" onclick="selectPlan('lite')">
                                    –ù–∞—á–∞—Ç—å –∑–∞ ‚ÇΩ79
                                </button>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- STARTER Plan -->
                <div class="col-xl-2-4 col-lg-3 col-md-6">
                    <div class="card h-100 border-0 shadow-sm">
                        <div class="card-body p-3 text-center">
                            <h3 class="card-title h6 mb-2">STARTER</h3>
                            <div class="mb-3">
                                <span class="h4 fw-bold text-secondary">‚ÇΩ149</span>
                                <div class="text-muted small">–≤ –Ω–µ–¥–µ–ª—é</div>
                                <div class="text-success" style="font-size: 0.7rem;">‚ÇΩ21/–¥–µ–Ω—å</div>
                            </div>
                            
                            <ul class="list-unstyled text-start mb-3 small">
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    15 –∞–Ω–∞–ª–∏–∑–æ–≤ –≤ –º–µ—Å—è—Ü
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    –î–æ 25 —Å—Ç—Ä–∞–Ω–∏—Ü PDF
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    5 –≤–∏–¥–µ–æ –¥–æ 30 –º–∏–Ω—É—Ç
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    100 AI —Å–æ–æ–±—â–µ–Ω–∏–π
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-star text-warning me-2"></i>
                                    –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PPTX
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    –ü—Ä–æ–≥—Ä–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è
                                </li>
                            </ul>
                            
                            {% if current_user.is_authenticated and user_subscription.type == 'starter' %}
                                <button class="btn btn-secondary btn-sm w-100" disabled>
                                    –¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω
                                </button>
                            {% else %}
                                <button class="btn btn-secondary btn-sm w-100" onclick="selectPlan('starter')">
                                    –í—ã–±—Ä–∞—Ç—å STARTER
                                </button>
                            {% endif %}
                        </div>
                    </div>
                </div>
                
                <!-- BASIC Plan -->
                <div class="col-xl-2-4 col-lg-3 col-md-6">
                    <div class="card h-100 border-warning shadow-lg position-relative">
                        <div class="position-absolute top-0 start-50 translate-middle">
                            <span class="badge bg-warning text-dark px-2 py-1 rounded-pill small">
                                üî• –ü–û–ü–£–õ–Ø–†–ù–´–ô
                            </span>
                        </div>
                        <div class="card-body p-3 text-center">
                            <h3 class="card-title h6 mb-2 text-warning">BASIC</h3>
                            <div class="mb-3">
                                <span class="h4 fw-bold text-warning">‚ÇΩ299</span>
                                <div class="text-muted small">–≤ –Ω–µ–¥–µ–ª—é</div>
                                <div class="text-success" style="font-size: 0.7rem;">‚ÇΩ43/–¥–µ–Ω—å</div>
                            </div>
                            
                            <ul class="list-unstyled text-start mb-3 small">
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    40 –∞–Ω–∞–ª–∏–∑–æ–≤ –≤ –º–µ—Å—è—Ü
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    –î–æ 50 —Å—Ç—Ä–∞–Ω–∏—Ü PDF
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    15 –≤–∏–¥–µ–æ –¥–æ 60 –º–∏–Ω—É—Ç
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    500 AI —Å–æ–æ–±—â–µ–Ω–∏–π
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    –ü–ª–∞–Ω—ã –æ–±—É—á–µ–Ω–∏—è
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-check text-success me-2"></i>
                                    –î–µ—Ç–∞–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
                                </li>
                            </ul>
                            
                            {% if current_user.is_authenticated and user_subscription.type == 'basic' %}
                                <button class="btn btn-warning btn-sm w-100" disabled>
                                    –¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω
                                </button>
                            {% else %}
                                <button class="btn btn-warning btn-sm w-100" onclick="selectPlan('basic')">
                                    –í—ã–±—Ä–∞—Ç—å BASIC
                                </button>
                            {% endif %}
                        </div>
                    </div>
                </div>
                
                <!-- PRO Plan -->
                <div class="col-xl-2-4 col-lg-3 col-md-6">
                    <div class="card h-100 border-success shadow-lg position-relative">
                        <div class="position-absolute top-0 start-50 translate-middle">
                            <span class="badge bg-success px-2 py-1 rounded-pill small">
                                ‚≠ê –õ–£–ß–®–ò–ô
                            </span>
                        </div>
                        <div class="card-body p-3 text-center">
                            <h3 class="card-title h6 mb-2 text-success">PRO</h3>
                            <div class="mb-3">
                                <span class="h4 fw-bold text-success">‚ÇΩ599</span>
                                <div class="text-muted small">–≤ –Ω–µ–¥–µ–ª—é</div>
                                <div class="text-success" style="font-size: 0.7rem;">‚ÇΩ85/–¥–µ–Ω—å</div>
                            </div>
                            
                            <ul class="list-unstyled text-start mb-3 small">
                                <li class="mb-1">
                                    <i class="fas fa-infinity text-success me-2"></i>
                                    –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ –∞–Ω–∞–ª–∏–∑—ã
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-infinity text-success me-2"></i>
                                    –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ PDF
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-infinity text-success me-2"></i>
                                    –ë–µ–∑–ª–∏–º–∏—Ç–Ω–æ–µ –≤–∏–¥–µ–æ
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-infinity text-success me-2"></i>
                                    –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π AI —á–∞—Ç
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-rocket text-success me-2"></i>
                                    –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
                                </li>
                                <li class="mb-1">
                                    <i class="fas fa-code text-success me-2"></i>
                                    API –¥–æ—Å—Ç—É–ø
                                </li>
                            </ul>
                            
                            {% if current_user.is_authenticated and user_subscription.type == 'pro' %}
                                <button class="btn btn-success btn-sm w-100" disabled>
                                    –¢–µ–∫—É—â–∏–π –ø–ª–∞–Ω
                                </button>
                            {% else %}
                                <button class="btn btn-success btn-sm w-100" onclick="selectPlan('pro')">
                                    –í—ã–±—Ä–∞—Ç—å PRO
                                </button>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- –°–æ—Ü–∏–∞–ª—å–Ω–æ–µ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ -->
            <div class="row justify-content-center mt-4">
                <div class="col-lg-10">
                    <div class="text-center">
                        <div class="row">
                            <div class="col-md-3">
                                <div class="h4 text-primary mb-0">12,847</div>
                                <small class="text-muted">–∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</small>
                            </div>
                            <div class="col-md-3">
                                <div class="h4 text-warning mb-0">73%</div>
                                <small class="text-muted">–≤—ã–±–∏—Ä–∞—é—Ç BASIC</small>
                            </div>
                            <div class="col-md-3">
                                <div class="h4 text-success mb-0">4.9/5</div>
                                <small class="text-muted">—Å—Ä–µ–¥–Ω—è—è –æ—Ü–µ–Ω–∫–∞</small>
                            </div>
                            <div class="col-md-3">
                                <div class="h4 text-info mb-0">2.3—á</div>
                                <small class="text-muted">—ç–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤ –¥–µ–Ω—å</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            {% if current_user.is_authenticated %}
            <div class="row justify-content-center mt-5">
                <div class="col-lg-8">
                    <div class="card border-0 shadow-sm">
                        <div class="card-body p-4">
                            <h5 class="card-title mb-3">–í–∞—à–∞ —Ç–µ–∫—É—â–∞—è –ø–æ–¥–ø–∏—Å–∫–∞</h5>
                            <div class="row">
                                <div class="col-md-6">
                                    <p><strong>–ü–ª–∞–Ω:</strong> {{ user_subscription.type.upper() }}</p>
                                    <p><strong>–°—Ç–∞—Ç—É—Å:</strong> 
                                        <span class="badge bg-success">{{ user_subscription.status }}</span>
                                    </p>
                                </div>
                                <div class="col-md-6">
                                    <p><strong>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –∞–Ω–∞–ª–∏–∑–æ–≤:</strong> 
                                        {% if usage_stats.analyses.unlimited %}
                                            {{ usage_stats.analyses.used }} (–±–µ–∑–ª–∏–º–∏—Ç–Ω–æ)
                                        {% else %}
                                            {{ usage_stats.analyses.used }}/{{ usage_stats.analyses.limit }}
                                        {% endif %}
                                    </p>
                                    <p><strong>–°–±—Ä–æ—Å –ª–∏–º–∏—Ç–æ–≤:</strong> 
                                        {{ usage_stats.reset_date[:10] if usage_stats.reset_date else '–ù–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ' }}
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}
            
            <div class="row justify-content-center mt-5">
                <div class="col-lg-10">
                    <div class="text-center">
                        <h3 class="mb-4">–ß–∞—Å—Ç–æ –∑–∞–¥–∞–≤–∞–µ–º—ã–µ –≤–æ–ø—Ä–æ—Å—ã</h3>
                        <div class="accordion" id="faqAccordion">
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq1">
                                        –ú–æ–∂–Ω–æ –ª–∏ –∏–∑–º–µ–Ω–∏—Ç—å –ø–ª–∞–Ω –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è?
                                    </button>
                                </h2>
                                <div id="faq1" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        –î–∞, –≤—ã –º–æ–∂–µ—Ç–µ –æ–±–Ω–æ–≤–∏—Ç—å –∏–ª–∏ –ø–æ–Ω–∏–∑–∏—Ç—å —Å–≤–æ–π –ø–ª–∞–Ω –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤—Å—Ç—É–ø–∞—é—Ç –≤ —Å–∏–ª—É –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ.
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq2">
                                        –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤?
                                    </button>
                                </h2>
                                <div id="faq2" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        –ü—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–æ–≤ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ–º –æ–±–Ω–æ–≤–∏—Ç—å –ø–ª–∞–Ω. –î–æ—Å—Ç—É–ø –∫ —É–∂–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–º –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.
                                    </div>
                                </div>
                            </div>
                            
                            <div class="accordion-item">
                                <h2 class="accordion-header">
                                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#faq3">
                                        –ï—Å—Ç—å –ª–∏ —Å–∫–∏–¥–∫–∏ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤?
                                    </button>
                                </h2>
                                <div id="faq3" class="accordion-collapse collapse" data-bs-parent="#faqAccordion">
                                    <div class="accordion-body">
                                        –î–∞, –º—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º —Å–∫–∏–¥–∫–∏ –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —É—á—Ä–µ–∂–¥–µ–Ω–∏–π. –°–≤—è–∂–∏—Ç–µ—Å—å —Å –Ω–∞–º–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
function selectPlan(planType) {
    // –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –∫–ª–∏–∫ –ø–æ –ø–ª–∞–Ω—É
    trackPlanClick(planType);
    
    {% if current_user.is_authenticated %}
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–æ–ª–µ–µ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ–µ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤–º–µ—Å—Ç–æ confirm
        showPlanConfirmation(planType);
    {% else %}
        // –î–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        showRegistrationModal(planType);
    {% endif %}
}

function showPlanConfirmation(planType) {
    const planNames = {
        'freemium': 'FREEMIUM',
        'lite': 'LITE',
        'starter': 'STARTER',
        'basic': 'BASIC', 
        'pro': 'PRO'
    };
    
    const planPrices = {
        'freemium': '‚ÇΩ0',
        'lite': '‚ÇΩ79/–Ω–µ–¥–µ–ª—è',
        'starter': '‚ÇΩ149/–Ω–µ–¥–µ–ª—è',
        'basic': '‚ÇΩ299/–Ω–µ–¥–µ–ª—è',
        'pro': '‚ÇΩ599/–Ω–µ–¥–µ–ª—è'
    };
    
    if (confirm(`üöÄ –ü–µ—Ä–µ—Ö–æ–¥–∏–º –Ω–∞ –ø–ª–∞–Ω ${planNames[planType]}?\n\nüí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: ${planPrices[planType]}\n‚ú® –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤—Å—Ç—É–ø—è—Ç –≤ —Å–∏–ª—É –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ\n\n–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?`)) {
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
        const button = event.target;
        const originalText = button.textContent;
        button.disabled = true;
        button.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>–û–±–Ω–æ–≤–ª—è–µ–º...';
        
        fetch('/upgrade_subscription', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                plan: planType
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É—Å–ø–µ—à–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
                button.innerHTML = '<i class="fas fa-check me-2"></i>–£—Å–ø–µ—à–Ω–æ!';
                button.classList.remove('btn-warning', 'btn-primary', 'btn-success', 'btn-dark');
                button.classList.add('btn-success');
                
                setTimeout(() => {
                    location.reload();
                }, 1500);
            } else {
                alert('‚ùå –û—à–∏–±–∫–∞: ' + data.error);
                button.disabled = false;
                button.textContent = originalText;
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–ª–∞–Ω–∞');
            button.disabled = false;
            button.textContent = originalText;
        });
    }
}

function showRegistrationModal(planType) {
    const planNames = {
        'freemium': 'FREEMIUM',
        'starter': 'STARTER', 
        'basic': 'BASIC',
        'pro': 'PRO'
    };
    
    if (confirm(`üéØ –•–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–ª–∞–Ω—É ${planNames[planType]}?\n\n‚úÖ –ë—ã—Å—Ç—Ä–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∑–∞ 30 —Å–µ–∫—É–Ω–¥\nüéÅ –ë–æ–Ω—É—Å: +1 –∞–Ω–∞–ª–∏–∑ –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏\nüöÄ –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º\n\n–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è —Å–µ–π—á–∞—Å?`)) {
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–ª–∞–Ω –≤ localStorage –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–±–æ—Ä–∞ –ø–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        localStorage.setItem('selectedPlan', planType);
        window.location.href = '/register?plan=' + planType;
    }
}
</script>

<style>
.card {
    transition: transform 0.2s ease-in-out;
}

.card:hover {
    transform: translateY(-5px);
}

.badge.bg-gradient-primary {
    background: linear-gradient(45deg, #007bff, #0056b3);
}

.display-4, .display-5 {
    font-weight: 700;
}

.accordion-button:not(.collapsed) {
    background-color: #f8f9fa;
    color: #0056b3;
}

/* –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è 5 –∫–æ–ª–æ–Ω–æ–∫ */
@media (min-width: 1200px) {
    .col-xl-2-4 {
        flex: 0 0 auto;
        width: 20%;
    }
}

@media (min-width: 992px) and (max-width: 1199px) {
    .col-lg-3 {
        flex: 0 0 auto;
        width: 33.333333%;
    }
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–ª–∞–Ω–∞ LITE */
.border-info {
    border: 2px solid #0dcaf0 !important;
    box-shadow: 0 0 20px rgba(13, 202, 240, 0.3) !important;
}

.card.border-info::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    background: linear-gradient(45deg, transparent, rgba(13, 202, 240, 0.1), transparent);
    border-radius: 0.375rem;
    z-index: -1;
}

/* –ê–Ω–∏–º–∞—Ü–∏—è –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è */
@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
}

.alert-warning {
    animation: pulse 2s infinite;
}

/* –ì—Ä–∞–¥–∏–µ–Ω—Ç—ã –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ */
.border-warning {
    border: 2px solid #ffc107 !important;
    box-shadow: 0 0 20px rgba(255, 193, 7, 0.3) !important;
}

.border-success {
    border: 2px solid #198754 !important;
    box-shadow: 0 0 20px rgba(25, 135, 84, 0.3) !important;
}

/* –≠—Ñ—Ñ–µ–∫—Ç –¥–ª—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤ */
.card.border-warning::before,
.card.border-success::before {
    content: '';
    position: absolute;
    top: -2px;
    left: -2px;
    right: -2px;
    bottom: -2px;
    background: linear-gradient(45deg, transparent, rgba(255, 193, 7, 0.1), transparent);
    border-radius: 0.375rem;
    z-index: -1;
}

.card.border-success::before {
    background: linear-gradient(45deg, transparent, rgba(25, 135, 84, 0.1), transparent);
}
</style>

<script>
// –¢–∞–π–º–µ—Ä –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –æ—Ç—Å—á–µ—Ç–∞
function updateCountdown() {
    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞—Ç—É –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞–∫—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ 2 –¥–Ω—è 14 —á–∞—Å–æ–≤)
    const endDate = new Date();
    endDate.setDate(endDate.getDate() + 2);
    endDate.setHours(endDate.getHours() + 14);
    
    const now = new Date();
    const timeLeft = endDate - now;
    
    if (timeLeft > 0) {
        const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
        const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
        
        document.getElementById('countdown').textContent = `${days}–¥ ${hours}—á ${minutes}–º`;
    } else {
        document.getElementById('countdown').textContent = '–ê–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞';
    }
}

// –û–±–Ω–æ–≤–ª—è–µ–º –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
setInterval(updateCountdown, 60000);
updateCountdown(); // –ó–∞–ø—É—Å–∫–∞–µ–º —Å—Ä–∞–∑—É

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∫–ª–∏–∫–æ–≤ –ø–æ –ø–ª–∞–Ω–∞–º
function trackPlanClick(planType) {
    // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–∏—Ç–∏–∫—É
    console.log(`User clicked on ${planType} plan`);
    
    // –ú–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ –≤ Google Analytics –∏–ª–∏ –¥—Ä—É–≥—É—é —Å–∏—Å—Ç–µ–º—É
    if (typeof gtag !== 'undefined') {
        gtag('event', 'plan_click', {
            'plan_type': planType,
            'event_category': 'subscription',
            'event_label': planType
        });
    }
}
</script>
{% endblock %}