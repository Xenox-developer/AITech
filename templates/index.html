{% extends "base.html" %}

{% block title %}AI-–∫–æ–Ω—Å–ø–µ–∫—Ç Pro - –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑{% endblock %}

{% block extra_styles %}
<style>
    .feature-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 15px;
        transition: transform 0.3s ease;
    }
    .feature-card:hover {
        transform: translateY(-5px);
    }
    .feature-icon {
        font-size: 2rem;
        margin-bottom: 10px;
    }
    .stats-card {
        background: #f8f9fa;
        border: none;
        border-radius: 10px;
        padding: 20px;
        text-align: center;
        box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .upload-area {
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
    }
    .upload-area:hover {
        background: linear-gradient(135deg, #e9ecef 0%, #b8c6db 100%);
    }
    .badge-new {
        background: #ff6b6b;
        color: white;
        padding: 2px 8px;
        border-radius: 10px;
        font-size: 0.75rem;
        margin-left: 5px;
    }
</style>
{% endblock %}

{% block content %}
<div class="main-container">
    <div class="text-center mb-5">
        <h1 class="display-4">
            <i class="fas fa-brain text-primary me-3"></i>AI-–∫–æ–Ω—Å–ø–µ–∫—Ç 
            <span class="badge bg-primary">Pro</span>
        </h1>
        <p class="lead text-muted">
            –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å –∏–µ—Ä–∞—Ä—Ö–∏–µ–π —Ç–µ–º, –º–µ–Ω—Ç–∞–ª—å–Ω—ã–º–∏ –∫–∞—Ä—Ç–∞–º–∏ –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–º –ø–ª–∞–Ω–æ–º –æ–±—É—á–µ–Ω–∏—è
        </p>
    </div>

    <!-- New Features Section -->
    <div class="row mb-5">
        <div class="col-md-3">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-sitemap"></i>
                </div>
                <h5>–ò–µ—Ä–∞—Ä—Ö–∏—è —Ç–µ–º</h5>
                <small>–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –¥–µ—Ä–µ–≤–æ –∑–Ω–∞–Ω–∏–π</small>
            </div>
        </div>
        <div class="col-md-3">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-project-diagram"></i>
                </div>
                <h5>Mind Map</h5>
                <small>–í–∏–∑—É–∞–ª—å–Ω—ã–µ —Å–≤—è–∑–∏ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π</small>
            </div>
        </div>
        <div class="col-md-3">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-calendar-check"></i>
                </div>
                <h5>–ü–ª–∞–Ω –æ–±—É—á–µ–Ω–∏—è</h5>
                <small>–ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ</small>
            </div>
        </div>
        <div class="col-md-3">
            <div class="feature-card">
                <div class="feature-icon">
                    <i class="fas fa-layer-group"></i>
                </div>
                <h5>–£–º–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏</h5>
                <small>5 —Ç–∏–ø–æ–≤ —Å —É—Ä–æ–≤–Ω—è–º–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏</small>
            </div>
        </div>
    </div>

    <!-- Upload Form -->
    <form id="upload-form" action="{{ url_for('upload_file') }}" method="POST" enctype="multipart/form-data">
        <input type="file" name="file" id="file-input" accept=".pdf,.mp4,.mov,.mkv" style="display: none;" required>
        
        <div class="upload-area" id="upload-area">
            <i class="fas fa-cloud-upload-alt fa-4x text-primary mb-3"></i>
            <h3>–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª —Å—é–¥–∞ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ –¥–ª—è –≤—ã–±–æ—Ä–∞</h3>
            <p class="text-muted mt-3">
                <i class="fas fa-file-pdf text-danger me-2"></i>PDF (–¥–æ 30 –ú–ë)
                <span class="mx-2">|</span>
                <i class="fas fa-video text-info me-2"></i>MP4, MOV, MKV (–¥–æ {{ config.MAX_CONTENT_LENGTH // (1024*1024) }} –ú–ë)
                <span class="badge-new">NEW: –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ –¥–ª—è –≤–∏–¥–µ–æ</span>
            </p>
            <button type="button" class="btn btn-primary btn-lg mt-3" onclick="document.getElementById('file-input').click()">
                <i class="fas fa-upload me-2"></i>–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª
            </button>
        </div>
        
        <div id="file-selected" style="display: none;" class="text-center mt-4">
            <div class="card">
                <div class="card-body">
                    <i class="fas fa-file-check fa-3x text-success mb-3"></i>
                    <h4 id="file-name"></h4>
                    <p class="text-muted" id="file-size"></p>
                    <button type="submit" class="btn btn-success btn-lg mt-3">
                        <i class="fas fa-rocket me-2"></i>–ù–∞—á–∞—Ç—å –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑
                    </button>
                    <button type="button" class="btn btn-secondary btn-sm mt-2" onclick="resetUpload()">
                        –í—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–π —Ñ–∞–π–ª
                    </button>
                </div>
            </div>
        </div>
    </form>

    <!-- What's New Section -->
    <div class="mt-5">
        <h4 class="text-center mb-4">üöÄ –ß—Ç–æ –Ω–æ–≤–æ–≥–æ –≤ Pro –≤–µ—Ä—Å–∏–∏</h4>
        <div class="row">
            <div class="col-md-4">
                <div class="stats-card">
                    <i class="fas fa-brain fa-2x text-primary mb-2"></i>
                    <h5>–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑</h5>
                    <p class="text-muted mb-0">10+ —Ç–µ–º —Å –ø–æ–¥—Ç–µ–º–∞–º–∏ –∏ –ø—Ä–∏–º–µ—Ä–∞–º–∏</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="stats-card">
                    <i class="fas fa-chart-line fa-2x text-success mb-2"></i>
                    <h5>–û—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞</h5>
                    <p class="text-muted mb-0">4 –º–µ—Ç—Ä–∏–∫–∏ –≥–ª—É–±–∏–Ω—ã –∞–Ω–∞–ª–∏–∑–∞</p>
                </div>
            </div>
            <div class="col-md-4">
                <div class="stats-card">
                    <i class="fas fa-sync fa-2x text-info mb-2"></i>
                    <h5>Spaced Repetition</h5>
                    <p class="text-muted mb-0">–ê–ª–≥–æ—Ä–∏—Ç–º SuperMemo –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫</p>
                </div>
            </div>
        </div>
    </div>

    <div class="mt-4 text-center text-muted">
        <p><i class="fas fa-magic me-2"></i>–û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–∫–ª—é—á–∞–µ—Ç: –∏–µ—Ä–∞—Ä—Ö–∏—é —Ç–µ–º, —Å–≤—è–∑–∏ –º–µ–∂–¥—É –∫–æ–Ω—Ü–µ–ø—Ü–∏—è–º–∏, –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã</p>
        <p><i class="fas fa-clock me-2"></i>–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∑–∞–Ω–∏–º–∞–µ—Ç 2-5 –º–∏–Ω—É—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–±—ä–µ–º–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–∞</p>
    </div>
</div>

<!-- Enhanced Processing Modal -->
<div class="modal fade" id="processingModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-body text-center py-5">
                <div class="mb-4">
                    <div class="spinner-grow text-primary" role="status"></div>
                    <div class="spinner-grow text-success" role="status"></div>
                    <div class="spinner-grow text-info" role="status"></div>
                    <div class="spinner-grow text-warning" role="status"></div>
                </div>
                <h4>üß† –ü—Ä–æ–≤–æ–¥–∏–º –≥–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Å –ø–æ–º–æ—â—å—é –ò–ò</h4>
                <div class="mt-4">
                    <div class="text-start" style="max-width: 500px; margin: 0 auto;">
                        <p class="mb-2"><i class="fas fa-check-circle text-success me-2"></i>–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞...</p>
                        <p class="mb-2 text-muted"><i class="fas fa-spinner fa-spin me-2"></i>–ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –∏–µ—Ä–∞—Ä—Ö–∏–∏ —Ç–µ–º...</p>
                        <p class="mb-2 text-muted"><i class="far fa-circle me-2"></i>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç—ã...</p>
                        <p class="mb-2 text-muted"><i class="far fa-circle me-2"></i>–°–æ–∑–¥–∞–Ω–∏–µ —É–º–Ω—ã—Ö —Ñ–ª–µ—à-–∫–∞—Ä—Ç...</p>
                        <p class="mb-2 text-muted"><i class="far fa-circle me-2"></i>–°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ –æ–±—É—á–µ–Ω–∏—è...</p>
                    </div>
                </div>
                <div class="progress mt-4" style="height: 10px;">
                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-gradient" style="width: 100%"></div>
                </div>
                <p class="text-muted mt-3 mb-0">–≠—Ç–æ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å 2-5 –º–∏–Ω—É—Ç –¥–ª—è –≥–ª—É–±–æ–∫–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script>
    const uploadArea = document.getElementById('upload-area');
    const fileInput = document.getElementById('file-input');
    const uploadForm = document.getElementById('upload-form');
    const fileSelectedDiv = document.getElementById('file-selected');

    // Drag and drop
    uploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadArea.classList.add('dragover');
    });

    uploadArea.addEventListener('dragleave', () => {
        uploadArea.classList.remove('dragover');
    });

    uploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadArea.classList.remove('dragover');
        const files = e.dataTransfer.files;
        if (files.length > 0) {
            fileInput.files = files;
            handleFileSelect();
        }
    });

    // Click to upload
    uploadArea.addEventListener('click', (e) => {
        if (e.target.tagName !== 'BUTTON' && !e.target.closest('button')) {
            fileInput.click();
        }
    });

    // File selection
    fileInput.addEventListener('change', handleFileSelect);

    function handleFileSelect() {
        if (fileInput.files.length > 0) {
            const file = fileInput.files[0];
            const fileName = file.name;
            const fileSize = (file.size / (1024 * 1024)).toFixed(2);
            
            // Show file info
            document.getElementById('file-name').textContent = fileName;
            document.getElementById('file-size').textContent = `–†–∞–∑–º–µ—Ä: ${fileSize} –ú–ë`;
            
            // Hide upload area and show file selected
            uploadArea.style.display = 'none';
            fileSelectedDiv.style.display = 'block';
        }
    }

    function resetUpload() {
        fileInput.value = '';
        uploadArea.style.display = 'block';
        fileSelectedDiv.style.display = 'none';
    }

    // Show enhanced processing modal on form submit
    uploadForm.addEventListener('submit', (e) => {
        if (fileInput.files.length === 0) {
            e.preventDefault();
            alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª');
            return false;
        }
        
        const modal = new bootstrap.Modal(document.getElementById('processingModal'));
        modal.show();
        
        // Animate processing steps
        setTimeout(() => {
            document.querySelectorAll('.modal-body p')[1].innerHTML = '<i class="fas fa-check-circle text-success me-2"></i>–ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∏ –∏–µ—Ä–∞—Ä—Ö–∏–∏ —Ç–µ–º...';
            document.querySelectorAll('.modal-body p')[2].innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç—ã...';
        }, 10000);
        
        setTimeout(() => {
            document.querySelectorAll('.modal-body p')[2].innerHTML = '<i class="fas fa-check-circle text-success me-2"></i>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∫–∞—Ä—Ç—ã...';
            document.querySelectorAll('.modal-body p')[3].innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>–°–æ–∑–¥–∞–Ω–∏–µ —É–º–Ω—ã—Ö —Ñ–ª–µ—à-–∫–∞—Ä—Ç...';
        }, 20000);
        
        setTimeout(() => {
            document.querySelectorAll('.modal-body p')[3].innerHTML = '<i class="fas fa-check-circle text-success me-2"></i>–°–æ–∑–¥–∞–Ω–∏–µ —É–º–Ω—ã—Ö —Ñ–ª–µ—à-–∫–∞—Ä—Ç...';
            document.querySelectorAll('.modal-body p')[4].innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>–°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∞ –æ–±—É—á–µ–Ω–∏—è...';
        }, 30000);
    });
</script>
{% endblock %}